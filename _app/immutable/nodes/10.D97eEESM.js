import"../chunks/DsnmJJEf.js";import"../chunks/Dreri0Nc.js";import{o as ae}from"../chunks/sDIuGG-g.js";import{p as re,l as se,a as oe,b as ne,g as t,m as T,s as l,c as s,d as n,r as o,f as A,u as G,n as O,t as ct,h as m}from"../chunks/BA9zlQXs.js";import{s as X}from"../chunks/CxGsrVHP.js";import{i as _t}from"../chunks/5idYV8Eq.js";import{e as yt,i as le}from"../chunks/DHhalKro.js";import{f,a as i,c as Pt,t as z,b as $t}from"../chunks/D2T3iFuq.js";import{r as j,s as zt}from"../chunks/CN9_JMpm.js";import{e as Dt}from"../chunks/DEKlhpFx.js";import{b as I}from"../chunks/j0kaSfka.js";import{i as ie}from"../chunks/DVSe7J_H.js";import{a as st,L as de,n as ht}from"../chunks/DFIjbTXV.js";import{c as ue}from"../chunks/BvDYI0fq.js";import{B as Y}from"../chunks/dm43JwH2.js";import{u as pe,C as v,P as Vt}from"../chunks/Xw1Er8YH.js";var ve=$t(`<svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.8"><path stroke-linecap="round" stroke-linejoin="round" d="M13.875 18.825A10.05 10.05 0 0112 19c-5.523 0-10-4.477-10-10
                                                0-1.08.172-2.12.49-3.096M6.223 6.223A9.955 9.955 0 0112 5
                                                c5.523 0 10 4.477 10 10a9.956 9.956 0 01-4.02 7.977M15 12a3 3 0 11-6 0
                                                3 3 0 016 0z"></path><path stroke-linecap="round" stroke-linejoin="round" d="M3 3l18 18"></path></svg>`),ce=$t(`<svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.8"><path stroke-linecap="round" stroke-linejoin="round" d="M2.458 12C3.732 7.943 7.523 5 12 5
                                                c4.478 0 8.268 2.943 9.542 7
                                                -1.274 4.057-5.064 7-9.542 7
                                                -4.477 0-8.268-2.943-9.542-7z"></path><path stroke-linecap="round" stroke-linejoin="round" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path></svg>`),_e=f("<!> <!>",1),he=f("<!> <!>",1),me=f("<!> <!>",1),fe=f('<tr><td><input type="text" class="input w-full"/></td><td><input type="text" class="input w-full"/></td><td><input type="text" class="input w-full"/></td><td><div class="relative"><input class="input w-full pr-10"/> <button type="button" class="absolute right-2 top-1/2 -translate-y-1/2 text-gray-500 hover:text-gray-800" aria-label="Toggle password visibility"><!></button></div></td><td><input type="text" class="input w-full"/></td><td><!></td><td class="space-x-2 whitespace-nowrap"><!> <!></td></tr>'),$e=f('<tr><td> </td><td> </td><td> </td><td>********</td><td> </td><td> </td><td class="space-x-2"><!> <!></td></tr>'),ge=$t(`<svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.8"><path stroke-linecap="round" stroke-linejoin="round" d="M13.875 18.825A10.05 10.05 0 0112 19c-5.523 0-10-4.477-10-10
                                            0-1.08.172-2.12.49-3.096M6.223 6.223A9.955 9.955 0 0112 5
                                            c5.523 0 10 4.477 10 10a9.956 9.956 0 01-4.02 7.977M15 12a3 3 0 11-6 0
                                            3 3 0 016 0z"></path><path stroke-linecap="round" stroke-linejoin="round" d="M3 3l18 18"></path></svg>`),be=$t(`<svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.8"><path stroke-linecap="round" stroke-linejoin="round" d="M2.458 12C3.732 7.943 7.523 5 12 5
                                            c4.478 0 8.268 2.943 9.542 7
                                            -1.274 4.057-5.064 7-9.542 7
                                            -4.477 0-8.268-2.943-9.542-7z"></path><path stroke-linecap="round" stroke-linejoin="round" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path></svg>`),we=f("<!> <!>",1),xe=f("<!> <!>",1),ke=f("<!> <!>",1),ye=f('<tr><td><input type="text" class="input w-full"/></td><td><input type="text" class="input w-full"/></td><td><input type="text" class="input w-full"/></td><td><div class="relative"><input class="input w-full pr-10"/> <button type="button" class="absolute right-2 top-1/2 -translate-y-1/2 text-gray-500 hover:text-gray-800" aria-label="Toggle password visibility"><!></button></div></td><td><input type="text" class="input w-full"/></td><td><!></td><td class="space-x-2 whitespace-nowrap"><!> <!></td></tr>'),Pe=f('<tr><td colspan="7"><!></td></tr>'),Ce=f('<div class="fixed inset-0 bg-white/70 flex items-center justify-center z-50"><!></div>'),je=f('<div class="table-wrap"><table class="table caption-bottom"><thead><tr><th>Username</th><th>Nama</th><th>Email</th><th>Password</th><th>No. HP</th><th>Posisi</th><th>Action</th></tr></thead><tbody><!><!></tbody></table> <!></div>');function qe(Jt,Et){re(Et,!1);const ot=T();let q=T(!1),D=T(!1),a=T({user_id:"",username:"",nama:"",email:"",password:"",no_hp:"",role:"user",jabatan:""});const Ht=e=>{n(R,"edit"),n(F,e.user_id),n(a,{user_id:e.user_id,username:e.username,nama:e.nama,email:e.email,password:"",no_hp:e.no_hp,role:e.role,jabatan:e.jabatan}),n(V,t(a).jabatan?[String(t(a).jabatan)]:[]),n($,y)},Nt=()=>{n(R,"add"),n(F,""),n(a,{user_id:"",username:"",nama:"",email:"",password:"",no_hp:"",role:"user",jabatan:""}),n(V,t(a).jabatan?[String(t(a).jabatan)]:[]),n($,y)},Ct=async()=>{n(q,!0);try{if(t(a).password===""&&delete t(a).password,t(R)==="edit"){await st.updateUser(t(a));const r=(await st.getUSerByID({user_id:t(F)})).user,p=t(M).findIndex(g=>g.user_id===t(F));m(M,t(M)[p]=r),ht?.success("Data user berhasil diperbarui")}else{delete t(a).user_id,await st.createUser(t(a));const r=(await st.getLastUser()).user;n(M,[...t(M),r]),ht?.success("Data user berhasil ditambahkan")}}catch(e){console.error(e),ht?.error("Gagal memperbarui data user")}n(q,!1),gt()},Gt=async e=>{if(await ue("Hapus data ini?")){n(q,!0);try{await st.deleteUser({user_id:e}),n(M,t(M).filter(p=>p.user_id!==e)),ht?.success("Data user berhasil dihapus")}catch(p){console.error(p),ht?.error("Gagal menghapus data user")}n(q,!1)}},gt=()=>{n(R,null),n(F,""),n(a,{user_id:"",username:"",nama:"",email:"",password:"",no_hp:"",role:"user",jabatan:""}),n(V,[]),n($,y)};let R=T(null),F=T(""),M=T([]);const qt=async()=>{n(q,!0);try{const e=await st.getUser();n(M,e.users)}catch(e){console.error(e)}n(q,!1)};ae(()=>{qt()});const Rt=e=>{switch(e){case"admin":return"Admin";case"dispatcher":return"Dispatcher";case"supervisor":return"Supervisor";case"operator":return"Operator";default:return"User"}},y=[{value:"admin",label:"Admin"},{value:"dispatcher",label:"Dispatcher"},{value:"supervisor",label:"Supervisor"},{value:"operator",label:"Operator"}];let $=T(y),V=T([]);const jt=()=>{n($,y)},Ft=()=>{const e=t(V)?.[0];return e?y.find(p=>String(p.value)===String(e))?.label??"":""},It=e=>{const r=(e.inputValue??"").toLowerCase(),p=Ft().toLowerCase();if(!r||r===p){n($,y);return}const g=y.filter(B=>B.label.toLowerCase().includes(r));n($,g.length?g:y)},Mt=e=>{n(V,e.value??[]),m(a,t(a).jabatan=t(V)?.[0]??"user"),n($,y)};se(()=>t($),()=>{n(ot,pe({items:t($),itemToString:e=>e.label,itemToValue:e=>e.value}))}),oe(),ie();var bt=je(),wt=s(bt),Bt=l(s(wt)),St=s(Bt);yt(St,1,()=>t(M),le,(e,r)=>{var p=Pt(),g=A(p);{var B=_=>{var P=fe(),b=s(P),K=s(b);j(K),o(b);var h=l(b),J=s(h);j(J),o(h);var S=l(h),Z=s(S);j(Z),o(S);var U=l(S),E=s(U),w=s(E);j(w);var L=l(w,2),tt=s(L);{var Q=u=>{var k=ve();i(u,k)},et=u=>{var k=ce();i(u,k)};_t(tt,u=>{t(D)?u(Q):u(et,!1)})}o(L),o(E),o(U);var x=l(U),d=s(x);j(d),o(x);var c=l(x),H=s(c);v(H,{class:"w-48",placeholder:"Pilih Posisi",get collection(){return t(ot)},onOpenChange:jt,onInputValueChange:It,onValueChange:Mt,get value(){return t(V)},multiple:!1,inputBehavior:"autohighlight",openOnClick:!0,children:(u,k)=>{var C=me(),at=A(C);v.Control(at,{$$events:{click:()=>t(ot)?.open?.()},children:(rt,xt)=>{var N=_e(),W=A(N);v.Input(W,{});var dt=l(W,2);v.Trigger(dt,{}),i(rt,N)},$$slots:{default:!0}});var Ut=l(at,2);Vt(Ut,{children:(rt,xt)=>{v.Positioner(rt,{children:(N,W)=>{v.Content(N,{class:"bg-white border shadow max-h-40 overflow-y-auto",children:(dt,Zt)=>{var ut=Pt(),ft=A(ut);yt(ft,1,()=>t($),pt=>pt.value,(pt,vt)=>{v.Item(pt,{get item(){return t(vt)},children:(Lt,kt)=>{var Tt=he(),At=A(Tt);v.ItemText(At,{children:(ee,Ie)=>{O();var Ot=z();ct(()=>X(Ot,(t(vt),G(()=>t(vt).label)))),i(ee,Ot)},$$slots:{default:!0}});var te=l(At,2);v.ItemIndicator(te,{}),i(Lt,Tt)},$$slots:{default:!0}})}),i(dt,ut)},$$slots:{default:!0}})},$$slots:{default:!0}})},$$slots:{default:!0}}),i(u,C)},$$slots:{default:!0}}),o(c);var lt=l(c),mt=s(lt);Y(mt,{severity:"success",$$events:{click:Ct},children:(u,k)=>{O();var C=z("Simpan");i(u,C)},$$slots:{default:!0}});var it=l(mt,2);Y(it,{severity:"danger",$$events:{click:gt},children:(u,k)=>{O();var C=z("Batal");i(u,C)},$$slots:{default:!0}}),o(lt),o(P),ct(()=>zt(w,"type",t(D)?"text":"password")),I(K,()=>t(a).username,u=>m(a,t(a).username=u)),I(J,()=>t(a).nama,u=>m(a,t(a).nama=u)),I(Z,()=>t(a).email,u=>m(a,t(a).email=u)),I(w,()=>t(a).password,u=>m(a,t(a).password=u)),Dt("click",L,()=>n(D,!t(D))),I(d,()=>t(a).no_hp,u=>m(a,t(a).no_hp=u)),i(_,P)},nt=_=>{var P=$e(),b=s(P),K=s(b,!0);o(b);var h=l(b),J=s(h,!0);o(h);var S=l(h),Z=s(S,!0);o(S);var U=l(S,2),E=s(U,!0);o(U);var w=l(U),L=s(w,!0);o(w);var tt=l(w),Q=s(tt);Y(Q,{severity:"success",$$events:{click:()=>Ht(t(r))},children:(x,d)=>{O();var c=z("Edit");i(x,c)},$$slots:{default:!0}});var et=l(Q,2);Y(et,{severity:"danger",$$events:{click:()=>Gt(t(r).user_id)},children:(x,d)=>{O();var c=z("Hapus");i(x,c)},$$slots:{default:!0}}),o(tt),o(P),ct(x=>{X(K,(t(r),G(()=>t(r).username))),X(J,(t(r),G(()=>t(r).nama))),X(Z,(t(r),G(()=>t(r).email))),X(E,(t(r),G(()=>t(r).no_hp))),X(L,x)},[()=>(t(r),G(()=>Rt(t(r).jabatan)))]),i(_,P)};_t(g,_=>{t(R),t(F),t(r),G(()=>t(R)==="edit"&&t(F)===t(r).user_id)?_(B):_(nt,!1)})}i(e,p)});var Kt=l(St);{var Qt=e=>{var r=ye(),p=s(r),g=s(p);j(g),o(p);var B=l(p),nt=s(B);j(nt),o(B);var _=l(B),P=s(_);j(P),o(_);var b=l(_),K=s(b),h=s(K);j(h);var J=l(h,2),S=s(J);{var Z=d=>{var c=ge();i(d,c)},U=d=>{var c=be();i(d,c)};_t(S,d=>{t(D)?d(Z):d(U,!1)})}o(J),o(K),o(b);var E=l(b),w=s(E);j(w),o(E);var L=l(E),tt=s(L);v(tt,{class:"w-48",placeholder:"Pilih Posisi",get collection(){return t(ot)},onOpenChange:jt,onInputValueChange:It,onValueChange:Mt,get value(){return t(V)},multiple:!1,inputBehavior:"autohighlight",openOnClick:!0,children:(d,c)=>{var H=ke(),lt=A(H);v.Control(lt,{$$events:{click:()=>t(ot)?.open?.()},children:(it,u)=>{var k=we(),C=A(k);v.Input(C,{});var at=l(C,2);v.Trigger(at,{}),i(it,k)},$$slots:{default:!0}});var mt=l(lt,2);Vt(mt,{children:(it,u)=>{v.Positioner(it,{children:(k,C)=>{v.Content(k,{class:"bg-white border shadow max-h-40 overflow-y-auto",children:(at,Ut)=>{var rt=Pt(),xt=A(rt);yt(xt,1,()=>t($),N=>N.value,(N,W)=>{v.Item(N,{get item(){return t(W)},children:(dt,Zt)=>{var ut=xe(),ft=A(ut);v.ItemText(ft,{children:(vt,Lt)=>{O();var kt=z();ct(()=>X(kt,(t(W),G(()=>t(W).label)))),i(vt,kt)},$$slots:{default:!0}});var pt=l(ft,2);v.ItemIndicator(pt,{}),i(dt,ut)},$$slots:{default:!0}})}),i(at,rt)},$$slots:{default:!0}})},$$slots:{default:!0}})},$$slots:{default:!0}}),i(d,H)},$$slots:{default:!0}}),o(L);var Q=l(L),et=s(Q);Y(et,{severity:"success",$$events:{click:Ct},children:(d,c)=>{O();var H=z("Simpan");i(d,H)},$$slots:{default:!0}});var x=l(et,2);Y(x,{severity:"danger",$$events:{click:gt},children:(d,c)=>{O();var H=z("Batal");i(d,H)},$$slots:{default:!0}}),o(Q),o(r),ct(()=>zt(h,"type",t(D)?"text":"password")),I(g,()=>t(a).username,d=>m(a,t(a).username=d)),I(nt,()=>t(a).nama,d=>m(a,t(a).nama=d)),I(P,()=>t(a).email,d=>m(a,t(a).email=d)),I(h,()=>t(a).password,d=>m(a,t(a).password=d)),Dt("click",J,()=>n(D,!t(D))),I(w,()=>t(a).no_hp,d=>m(a,t(a).no_hp=d)),i(e,r)},Wt=e=>{var r=Pe(),p=s(r),g=s(p);Y(g,{severity:"success",$$events:{click:Nt},children:(B,nt)=>{O();var _=z("+ Tambah");i(B,_)},$$slots:{default:!0}}),o(p),o(r),i(e,r)};_t(Kt,e=>{t(R)==="add"?e(Qt):e(Wt,!1)})}o(Bt),o(wt);var Xt=l(wt,2);{var Yt=e=>{var r=Ce(),p=s(r);de(p,{}),o(r),i(e,r)};_t(Xt,e=>{t(q)&&e(Yt)})}o(bt),i(Jt,bt),ne()}export{qe as component};
