import"../chunks/DsnmJJEf.js";import"../chunks/Dreri0Nc.js";import{o as It}from"../chunks/sDIuGG-g.js";import{p as St,l as k,a as Dt,b as jt,g as t,m as v,d as s,c as o,s as l,u as T,r as i,t as ut,f as At,n as I,h as S}from"../chunks/BA9zlQXs.js";import{s as Q}from"../chunks/CxGsrVHP.js";import{i as R}from"../chunks/5idYV8Eq.js";import{e as _t,i as ft}from"../chunks/DHhalKro.js";import{f as V,a as d,c as Et,t as D}from"../chunks/D2T3iFuq.js";import{a as Gt,r as H}from"../chunks/CN9_JMpm.js";import{e as mt}from"../chunks/DEKlhpFx.js";import{b as U}from"../chunks/j0kaSfka.js";import{i as Ht}from"../chunks/DVSe7J_H.js";import{a as q,L as Ut,n as N}from"../chunks/D4MCqZJT.js";import{B as j}from"../chunks/dm43JwH2.js";import{c as qt}from"../chunks/BvDYI0fq.js";import{S as zt,T as Ft}from"../chunks/CS2betOZ.js";var Mt=V("<button> </button>"),Nt=V('<button class="px-3 py-1.5 rounded-lg text-sm font-medium bg-red-500 text-white hover:bg-red-600 transition-colors">Clear</button>'),Qt=V('<tr><td><input class="input w-full" type="text"/></td><td><input class="input w-full" type="text"/></td><td><input class="input w-full" type="text" inputmode="number" pattern="[0-9]*"/></td><td class="space-x-2 whitespace-nowrap"><!> <!></td></tr>'),Rt=V('<tr><td> </td><td> </td><td> </td><td class="space-x-2"><!> <!></td></tr>'),Jt=V('<tr><td><input class="input w-full" type="text"/></td><td><input class="input w-full" type="text"/></td><td><input class="input w-full" type="text" inputmode="number" pattern="[0-9]*"/></td><td class="space-x-2 whitespace-nowrap"><!> <!></td></tr>'),Ot=V('<tr><td colspan="7"><!></td></tr>'),Wt=V('<div class="fixed inset-0 bg-white/70 flex items-center justify-center z-50"><!></div>'),Xt=V('<div class="table-wrap mb-4"><div class="flex items-center justify-between gap-3 mb-3"><!> <div class="flex items-center gap-2"><span class="text-sm font-medium">Kapasitas:</span> <!> <!></div></div> <table class="table caption-bottom"><thead><tr><th>Plat</th><th>No. VT</th><th>Kapasitas</th><th>Action</th></tr></thead><tbody><!><!></tbody></table> <!> <!></div>');function _a(gt,ht){St(ht,!1);const st=v(),J=v(),O=v(),z=v(),W=v(),rt=v();let P=v(!1),f=v(""),A=v(1),E=v(10),c=v([]);const $t=a=>{t(c).includes(a)?s(c,t(c).filter(e=>e!==a)):s(c,[...t(c),a])},bt=()=>{s(c,[]),s(f,"")};let n=v({vt_id:"",plat:"",no_vt:"",kapasitas:""}),L=v(null),G=v("");const xt=a=>{s(L,"edit"),s(G,a.vt_id),s(n,{vt_id:a.vt_id,plat:a.plat,no_vt:a.no_vt,kapasitas:a.kapasitas})},ot=async()=>{s(P,!0);try{if(t(L)==="edit"){await q.updateVT(t(n));const e=(await q.getVTByID({vt_id:t(G)})).vt,r=t(u).findIndex(g=>g.vt_id===t(G));S(u,t(u)[r]=e),N?.success("Data VT berhasil diperbarui")}else{await q.createVT(t(n));const e=(await q.getLastVT()).vt;s(u,[...t(u),e]),N?.success("Data VT berhasil ditambahkan")}}catch(a){console.error(a),N?.error("Gagal memperbarui data VT")}s(P,!1),X()},X=()=>{s(L,null),s(G,""),s(n,{vt_id:"",plat:"",no_vt:"",kapasitas:""})},yt=()=>{s(L,"add"),s(n,{vt_id:"",plat:"",no_vt:"",kapasitas:""})},wt=async a=>{if(await qt("Hapus data ini?")){s(P,!0);try{await q.deleteVT({vt_id:a}),s(u,t(u).filter(r=>r.vt_id!==a)),N?.success("Data VT berhasil dihapus")}catch(r){console.error(r),N?.error("Gagal menghapus data VT")}s(P,!1)}};let u=v([]);const kt=async()=>{s(P,!0);const a=await q.getVT();s(u,a.vts),s(P,!1)};It(()=>{kt()});const it=a=>a.toString().replace(/\B(?=(\d{3})+(?!\d))/g,".");k(()=>t(u),()=>{s(st,[...new Set(t(u).map(a=>a.kapasitas))].sort((a,e)=>a-e))}),k(()=>(t(u),t(f),t(c)),()=>{s(J,t(u).filter(a=>{const e=(a?.plat??"").toLowerCase().includes((t(f)??"").toLowerCase())||(a?.no_vt??"").toLowerCase().includes((t(f)??"").toLowerCase()),r=t(c).length===0||t(c).includes(a.kapasitas);return e&&r}))}),k(()=>t(J),()=>{s(O,[...t(J)].sort((a,e)=>(a?.plat??"").localeCompare(e?.plat??"")))}),k(()=>(t(f),t(c)),()=>{(t(f)!==void 0||t(c))&&s(A,1)}),k(()=>t(f),()=>{t(f)!==void 0&&s(A,1)}),k(()=>(t(A),t(E)),()=>{s(z,(t(A)-1)*t(E))}),k(()=>(t(z),t(E)),()=>{s(W,t(z)+t(E))}),k(()=>(t(O),t(z),t(W)),()=>{s(rt,t(O).slice(t(z),t(W)))}),Dt(),Ht();var Y=Xt(),Z=o(Y),nt=o(Z);zt(nt,{placeholder:"Cari VT...",get value(){return t(f)},set value(a){s(f,a)},$$legacy:!0});var lt=l(nt,2),dt=l(o(lt),2);_t(dt,1,()=>t(st),ft,(a,e)=>{var r=Mt(),g=o(r);i(r),ut((b,B)=>{Gt(r,1,`px-3 py-1.5 rounded-lg text-sm font-medium transition-colors ${b??""}`),Q(g,`${B??""} L`)},[()=>(t(c),t(e),T(()=>t(c).includes(t(e))?"bg-blue-500 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300")),()=>(t(e),T(()=>it(t(e))))]),mt("click",r,()=>$t(t(e))),d(a,r)});var Tt=l(dt,2);{var Vt=a=>{var e=Nt();mt("click",e,bt),d(a,e)};R(Tt,a=>{t(c),t(f),T(()=>t(c).length>0||t(f))&&a(Vt)})}i(lt),i(Z);var tt=l(Z,2),ct=l(o(tt)),pt=o(ct);_t(pt,1,()=>t(rt),ft,(a,e)=>{var r=Et(),g=At(r);{var b=m=>{var h=Qt(),$=o(h),C=o($);H(C),i($);var x=l($),_=o(x);H(_),i(x);var y=l(x),w=o(y);H(w),i(y);var F=l(y),M=o(F);j(M,{severity:"success",$$events:{click:ot},children:(p,et)=>{I();var K=D("Simpan");d(p,K)},$$slots:{default:!0}});var at=l(M,2);j(at,{severity:"danger",$$events:{click:X},children:(p,et)=>{I();var K=D("Batal");d(p,K)},$$slots:{default:!0}}),i(F),i(h),U(C,()=>t(n).plat,p=>S(n,t(n).plat=p)),U(_,()=>t(n).no_vt,p=>S(n,t(n).no_vt=p)),U(w,()=>t(n).kapasitas,p=>S(n,t(n).kapasitas=p)),d(m,h)},B=m=>{var h=Rt(),$=o(h),C=o($,!0);i($);var x=l($),_=o(x,!0);i(x);var y=l(x),w=o(y);i(y);var F=l(y),M=o(F);j(M,{severity:"success",$$events:{click:()=>{xt(t(e))}},children:(p,et)=>{I();var K=D("Edit");d(p,K)},$$slots:{default:!0}});var at=l(M,2);j(at,{severity:"danger",$$events:{click:()=>{wt(t(e).vt_id)}},children:(p,et)=>{I();var K=D("Hapus");d(p,K)},$$slots:{default:!0}}),i(F),i(h),ut(p=>{Q(C,(t(e),T(()=>t(e).plat))),Q(_,(t(e),T(()=>t(e).no_vt))),Q(w,`${p??""} L`)},[()=>(t(e),T(()=>it(t(e).kapasitas)))]),d(m,h)};R(g,m=>{t(L),t(G),t(e),T(()=>t(L)==="edit"&&t(G)===t(e).vt_id)?m(b):m(B,!1)})}d(a,r)});var Pt=l(pt);{var Lt=a=>{var e=Jt(),r=o(e),g=o(r);H(g),i(r);var b=l(r),B=o(b);H(B),i(b);var m=l(b),h=o(m);H(h),i(m);var $=l(m),C=o($);j(C,{severity:"success",$$events:{click:ot},children:(_,y)=>{I();var w=D("Simpan");d(_,w)},$$slots:{default:!0}});var x=l(C,2);j(x,{severity:"danger",$$events:{click:X},children:(_,y)=>{I();var w=D("Batal");d(_,w)},$$slots:{default:!0}}),i($),i(e),U(g,()=>t(n).plat,_=>S(n,t(n).plat=_)),U(B,()=>t(n).no_vt,_=>S(n,t(n).no_vt=_)),U(h,()=>t(n).kapasitas,_=>S(n,t(n).kapasitas=_)),d(a,e)},Bt=a=>{var e=Ot(),r=o(e),g=o(r);j(g,{severity:"success",$$events:{click:yt},children:(b,B)=>{I();var m=D("+ Tambah");d(b,m)},$$slots:{default:!0}}),i(r),i(e),d(a,e)};R(Pt,a=>{t(L)==="add"?a(Lt):a(Bt,!1)})}i(ct),i(tt);var vt=l(tt,2);Ft(vt,{get totalItems(){return t(u),T(()=>t(u).length)},get page(){return t(A)},set page(a){s(A,a)},get perPage(){return t(E)},set perPage(a){s(E,a)},$$legacy:!0});var Ct=l(vt,2);{var Kt=a=>{var e=Wt(),r=o(e);Ut(r,{}),i(e),d(a,e)};R(Ct,a=>{t(P)&&a(Kt)})}i(Y),d(gt,Y),jt()}export{_a as component};
