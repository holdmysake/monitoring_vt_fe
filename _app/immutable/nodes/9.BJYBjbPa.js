import"../chunks/DsnmJJEf.js";import"../chunks/B-aUsau7.js";import{c as _r,o as br}from"../chunks/D6pxDlqU.js";import{p as wt,f as b,b as yt,aW as Sr,c as o,s,r,t as G,j as wr,u as p,g as e,m,d as a,l as De,a as kr,n as X}from"../chunks/DZj3V7hs.js";import{c as ce,a as c,f as w,t as He,b as $r}from"../chunks/Cmeh_zQv.js";import{i as Le}from"../chunks/C_Z-GkL4.js";import{b as tr}from"../chunks/BAXbHwTh.js";import{i as kt}from"../chunks/B2kuW2zI.js";import{f as rr}from"../chunks/DIg2_NEP.js";import{s as ar,a as Ue,r as Vr,c as Ir,n as Be,L as Cr,B as Mr}from"../chunks/71aaOmZ7.js";import{e as dt}from"../chunks/H2sK6pkz.js";import{p as ae}from"../chunks/CUQbSg7J.js";import{s as h}from"../chunks/6nlo_wlY.js";import{e as he,i as fr}from"../chunks/DUh4gHIz.js";import{s as Pr}from"../chunks/zgFPYRNL.js";import{c as Tr}from"../chunks/P9oBW4u-.js";import{C as g,P as xr,u as ze}from"../chunks/CzQj692N.js";import{B as Br}from"../chunks/ltPLFC_K.js";import{s as Dr}from"../chunks/BujHi0dY.js";var Hr=w('<div class="fixed inset-0 bg-black/60 backdrop-blur-sm z-50 flex items-center justify-center p-4 animate-in fade-in duration-200 svelte-1vv2w51" role="dialog" aria-modal="true" aria-labelledby="pdf-preview-title"><div class="bg-white rounded-2xl w-full max-w-6xl h-[90vh] flex flex-col shadow-2xl animate-in zoom-in-95 duration-200 svelte-1vv2w51"><div class="flex items-center justify-between px-6 py-4 border-b border-gray-200 bg-linear-to-r from-blue-50 to-indigo-50"><div class="flex items-center gap-3"><div class="w-10 h-10 rounded-xl bg-linear-to-br from-blue-500 to-indigo-600 flex items-center justify-center shadow-lg"><svg class="w-6 h-6 text-white" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path></svg></div> <div><h2 id="pdf-preview-title" class="text-lg font-bold text-gray-900">Preview Surat Jalan</h2> <p class="text-sm text-gray-500">Dokumen PDF</p></div></div> <div class="flex items-center gap-2"><a download="" class="p-2 rounded-lg hover:bg-white/50 transition-colors group" title="Download PDF"><svg class="w-5 h-5 text-gray-600 group-hover:text-blue-600" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"></path></svg></a> <a target="_blank" rel="noopener noreferrer" class="p-2 rounded-lg hover:bg-white/50 transition-colors group" title="Buka di tab baru"><svg class="w-5 h-5 text-gray-600 group-hover:text-blue-600" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"></path></svg></a> <button class="p-2 rounded-lg hover:bg-red-50 transition-colors group" title="Tutup"><svg class="w-5 h-5 text-gray-600 group-hover:text-red-600" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg></button></div></div> <div class="flex-1 overflow-hidden bg-gray-100"><iframe class="w-full h-full border-none" title="PDF Preview"></iframe></div></div></div>');function zr(_e,k){wt(k,!1);let Q=ae(k,"show",8,!1),B=ae(k,"pdfUrl",8,""),A=ae(k,"onClose",8,()=>{});const y=$=>{$.key==="Escape"&&Q()&&A()()},Z=$=>{$.target===$.currentTarget&&A()()};kt();var ee=ce();dt("keydown",Sr,y);var Y=b(ee);{var D=$=>{var S=Hr(),q=o(S),M=o(q),H=s(o(M),2),J=o(H),V=s(J,2),R=s(V,2);r(H),r(M);var z=s(M,2),N=o(z);r(z),r(q),r(S),G(()=>{ar(J,"href",B()),ar(V,"href",B()),ar(N,"src",B())}),dt("click",R,function(...oe){A()?.apply(this,oe)}),dt("click",S,Z),c($,S)};Le(Y,$=>{Q()&&$(D)})}c(_e,ee),yt()}var Lr=w('<div class="border-t border-gray-200 pt-3"><div class="text-xs text-gray-500 mb-2 font-medium">Shift 2</div> <div class="grid grid-cols-2 gap-2"><div class="text-sm text-gray-700"><span class="text-gray-500">Driver:</span> </div> <div class="text-sm text-gray-700"><span class="text-gray-500">Helper:</span> </div></div></div>'),Or=w('<div class="flex items-center gap-2 text-xs"><span class="inline-flex items-center px-2 py-0.5 rounded font-medium bg-blue-100 text-blue-800 min-w-25"> </span> <span class="text-gray-900"> </span></div>'),jr=w('<div class="mt-2 pt-2 border-t border-gray-100"><div class="text-xs text-gray-500 mb-1">Personel Trip:</div> <div class="space-y-1"></div></div>'),Fr=w('<div class="border border-gray-200 rounded-lg p-3 hover:bg-gray-50 transition-colors"><div class="flex items-center justify-between mb-2"><div class="text-xs font-semibold text-gray-900"></div> <div class="text-xs text-gray-500"> </div></div> <div class="grid grid-cols-2 gap-2 text-xs"><div><span class="text-gray-500">Loading:</span> <span class="font-medium text-gray-900"> </span></div> <div><span class="text-gray-500">Unloading:</span> <span class="font-medium text-gray-900"> </span></div> <div><span class="text-gray-500">Jam Loading:</span> <span class="font-medium text-gray-900"> </span></div> <div><span class="text-gray-500">Jam Unloading:</span> <span class="font-medium text-gray-900"> </span></div> <div class="col-span-2"><span class="text-gray-500">No. Segel:</span> <span class="font-medium text-gray-900"> </span></div></div> <!></div>'),Ar=w('<div class="space-y-3 max-h-64 overflow-y-auto pr-2"></div>'),Jr=w('<div class="text-center py-8 text-gray-500"><svg class="w-12 h-12 mx-auto mb-2 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20 13V6a2 2 0 00-2-2H6a2 2 0 00-2 2v7m16 0v5a2 2 0 01-2 2H6a2 2 0 01-2-2v-5m16 0h-2.586a1 1 0 00-.707.293l-2.414 2.414a1 1 0 01-.707.293h-3.172a1 1 0 01-.707-.293l-2.414-2.414A1 1 0 006.586 13H4"></path></svg> <p class="text-sm">Belum ada data trip</p></div>'),Rr=w('<tr class="bg-gray-50"><td colspan="6" class="px-6 py-4"><div class="grid grid-cols-1 lg:grid-cols-2 gap-6"><div class="space-y-4"><div class="bg-white rounded-lg p-4 shadow-sm border border-gray-200"><h4 class="text-sm font-semibold text-gray-900 mb-3 flex items-center gap-2"><svg class="w-4 h-4 text-blue-500" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg> Waktu Operasional</h4> <div class="grid grid-cols-2 gap-3"><div><div class="text-xs text-gray-500 mb-1">Keluar VT</div> <div class="text-sm font-medium text-gray-900"> </div></div> <div><div class="text-xs text-gray-500 mb-1">Kembali VT</div> <div class="text-sm font-medium text-gray-900"> </div></div></div></div> <div class="bg-white rounded-lg p-4 shadow-sm border border-gray-200"><h4 class="text-sm font-semibold text-gray-900 mb-3 flex items-center gap-2"><svg class="w-4 h-4 text-amber-500" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"></path></svg> Personel</h4> <div class="space-y-3"><div class="grid grid-cols-2 gap-3"><div><div class="text-xs text-gray-500 mb-1">Supervisor</div> <div class="text-sm font-medium text-gray-900"> </div></div> <div><div class="text-xs text-gray-500 mb-1">BBM</div> <div class="text-sm font-medium text-gray-900"> </div></div></div> <div class="border-t border-gray-200 pt-3"><div class="text-xs text-gray-500 mb-2 font-medium">Shift 1</div> <div class="grid grid-cols-2 gap-2"><div class="text-sm text-gray-700"><span class="text-gray-500">Driver:</span> </div> <div class="text-sm text-gray-700"><span class="text-gray-500">Helper:</span> </div></div></div> <!></div></div></div> <div class="bg-white rounded-lg p-4 shadow-sm border border-gray-200"><h4 class="text-sm font-semibold text-gray-900 mb-3 flex items-center gap-2"><svg class="w-4 h-4 text-green-500" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path></svg> </h4> <!></div></div></td></tr>'),Ur=w('<tr class="hover:bg-blue-50/50 transition-colors"><td class="px-6 py-4 whitespace-nowrap"><div class="flex items-center gap-2"><button class="p-1 hover:bg-gray-100 rounded transition-colors"><svg fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path></svg></button> <div><div class="text-sm font-semibold text-gray-900"> </div> <div class="text-xs text-gray-500"> </div></div></div></td><td class="px-6 py-4 whitespace-nowrap"><div class="text-sm text-gray-900"> </div></td><td class="px-6 py-4 whitespace-nowrap"><div class="flex items-center gap-2"><div class="w-8 h-8 rounded-lg bg-emerald-100 flex items-center justify-center"><svg class="w-5 h-5 text-emerald-600" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"></path></svg></div> <div><div class="text-sm font-medium text-gray-900"> </div> <div class="text-xs text-gray-500"> </div></div></div></td><td class="px-6 py-4"><div class="text-sm text-gray-900"> </div> <div class="text-xs text-gray-500"> </div></td><td class="px-6 py-4 text-center"><span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800"> </span></td><td class="px-6 py-4"><div class="flex items-center justify-center gap-2"><button class="inline-flex items-center gap-1 px-3 py-1.5 bg-blue-600 hover:bg-blue-700 text-white text-sm font-medium rounded-lg transition-colors" title="Preview PDF"><svg class="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"></path></svg> PDF</button> <button class="inline-flex items-center gap-1 px-3 py-1.5 bg-red-600 hover:bg-red-700 text-white text-sm font-medium rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed" title="Hapus Surat Jalan"><svg class="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path></svg> Hapus</button></div></td></tr> <!>',1),Yr=w('<div class="text-center py-12"><svg class="w-16 h-16 mx-auto mb-4 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path></svg> <p class="text-gray-500 text-lg font-medium mb-2">Tidak ada data surat jalan</p> <p class="text-gray-400 text-sm">Pilih range tanggal untuk melihat data</p></div>'),qr=w('<div class="bg-white rounded-xl shadow-sm overflow-hidden"><div class="px-6 py-4 border-b border-gray-200 bg-linear-to-r from-blue-50 to-indigo-50"><div class="flex items-center gap-3"><div class="w-10 h-10 rounded-xl bg-linear-to-br from-blue-500 to-indigo-600 flex items-center justify-center shadow-lg"><svg class="w-6 h-6 text-white" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path></svg></div> <div><h2 class="text-lg font-bold text-gray-900">Daftar Surat Jalan</h2> <p class="text-sm text-gray-500"> </p></div></div></div> <div class="overflow-x-auto"><table class="w-full"><thead class="bg-gray-50 border-b border-gray-200"><tr><th class="px-6 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider">No. Surat Jalan</th><th class="px-6 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider">Tanggal</th><th class="px-6 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider">Vacuum Truck</th><th class="px-6 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider">Rute</th><th class="px-6 py-3 text-center text-xs font-semibold text-gray-700 uppercase tracking-wider">Trip</th><th class="px-6 py-3 text-center text-xs font-semibold text-gray-700 uppercase tracking-wider">Aksi</th></tr></thead><tbody class="bg-white divide-y divide-gray-200"></tbody></table> <!></div></div>');function Er(_e,k){wt(k,!1);const Q=_r();let B=ae(k,"surjals",28,()=>[]),A=ae(k,"onPreview",8,()=>{}),y=m(new Set),Z=m(!1);const ee=_=>{e(y).has(_)?e(y).delete(_):e(y).add(_),a(y,e(y))},Y=_=>{const n=new Date(_),f=String(n.getUTCDate()).padStart(2,"0"),I=String(n.getUTCMonth()+1).padStart(2,"0"),E=n.getUTCFullYear();return`${f}-${I}-${E}`},D=_=>{const n=new Date(_),f=String(n.getUTCHours()).padStart(2,"0"),I=String(n.getUTCMinutes()).padStart(2,"0");return`${f}:${I}`},$=(_,n)=>_.find(f=>f.role===n)?.personel?.nama_personel||"-",S=_=>[..._].sort((n,f)=>{const I={driver:1,helper:2,op_loading:3,op_unloading:4};return(I[n.role]||99)-(I[f.role]||99)}),q=_=>({driver:"Driver",helper:"Helper",op_loading:"Operator Loading",op_unloading:"Operator Unloading"})[_]||_,M=async _=>{if(await Tr("Hapus Surat Jalan ini?","danger")){a(Z,!0);try{await Ue.deleteSJ({surat_jalan_id:_}),B(B().filter(f=>f.surat_jalan_id!==_)),e(y).has(_)&&(e(y).delete(_),a(y,e(y))),notyf?.success("Surat Jalan berhasil dihapus"),Q("refresh")}catch(f){console.error(f),notyf?.error(f.message||"Gagal menghapus Surat Jalan")}a(Z,!1)}};kt();var H=qr(),J=o(H),V=o(J),R=s(o(V),2),z=s(o(R),2),N=o(z);r(z),r(R),r(V),r(J);var oe=s(J,2),x=o(oe),P=s(o(x));he(P,5,B,fr,(_,n)=>{var f=Ur(),I=b(f),E=o(I),Oe=o(E),K=o(Oe),te=o(K);r(K);var L=s(K,2),U=o(L),W=o(U,!0);r(U);var je=s(U,2),se=o(je,!0);r(je),r(L),r(Oe),r(E);var ne=s(E),xe=o(ne),be=o(xe,!0);r(xe),r(ne);var Fe=s(ne),vt=o(Fe),Te=s(o(vt),2),we=o(Te),pe=o(we,!0);r(we);var re=s(we,2),ye=o(re,!0);r(re),r(Te),r(vt),r(Fe);var ge=s(Fe),$t=o(ge),or=o($t,!0);r($t);var Ft=s($t,2),Qe=o(Ft);r(Ft),r(ge);var ke=s(ge),Ye=o(ke),sr=o(Ye);r(Ye),r(ke);var At=s(ke),Jt=o(At),$e=o(Jt),Ce=s($e,2);r(Jt),r(At),r(I);var qe=s(I,2);{var nr=Xe=>{var Ze=Rr(),me=o(Ze),Se=o(me),Ve=o(Se),ct=o(Ve),Rt=s(o(ct),2),Ct=o(Rt),Ut=s(o(Ct),2),lr=o(Ut);r(Ut),r(Ct);var Yt=s(Ct,2),St=s(o(Yt),2),et=o(St);r(St),r(Yt),r(Rt),r(ct);var Ee=s(ct,2),Ke=s(o(Ee),2),Ae=o(Ke),Ne=o(Ae),tt=s(o(Ne),2),ir=o(tt,!0);r(tt),r(Ne);var qt=s(Ne,2),Et=s(o(qt),2),Ie=o(Et);r(Et),r(qt),r(Ae);var ut=s(Ae,2),pt=s(o(ut),2),gt=o(pt),Kt=s(o(gt));r(gt);var mt=s(gt,2),Vt=s(o(mt));r(mt),r(pt),r(ut);var Nt=s(ut,2);{var dr=ve=>{var le=Lr(),Je=s(o(le),2),C=o(Je),rt=s(o(C));r(C);var Me=s(C,2),at=s(o(Me));r(Me),r(Je),r(le),G((We,ot)=>{h(rt,` ${We??""}`),h(at,` ${ot??""}`)},[()=>(e(n),p(()=>$(e(n).personel_surat_jalan,"driver2"))),()=>(e(n),p(()=>$(e(n).personel_surat_jalan,"helper2")))]),c(ve,le)};Le(Nt,ve=>{e(n),p(()=>$(e(n).personel_surat_jalan,"driver2")!=="-")&&ve(dr)})}r(Ke),r(Ee),r(Ve);var It=s(Ve,2),Mt=o(It),Pt=s(o(Mt));r(Mt);var Tt=s(Mt,2);{var vr=ve=>{var le=Ar();he(le,5,()=>(e(n),p(()=>e(n).trip_surat_jalan)),fr,(Je,C,rt)=>{var Me=Fr(),at=o(Me),We=o(at);We.textContent=`Trip #${rt+1}`;var ot=s(We,2),Bt=o(ot,!0);r(ot),r(at);var Dt=s(at,2),ht=o(Dt),Gt=s(o(ht),2),Ht=o(Gt);r(Gt),r(ht);var ft=s(ht,2),xt=s(o(ft),2),Qt=o(xt);r(xt),r(ft);var st=s(ft,2),zt=s(o(st),2),cr=o(zt,!0);r(zt),r(st);var nt=s(st,2),Lt=s(o(nt),2),Ot=o(Lt,!0);r(Lt),r(nt);var jt=s(nt,2),_t=s(o(jt),2),ur=o(_t,!0);r(_t),r(jt),r(Dt);var pr=s(Dt,2);{var Xt=bt=>{var lt=jr(),Zt=s(o(lt),2);he(Zt,5,()=>(e(C),p(()=>S(e(C).personel_trip))),fr,(gr,Re)=>{var er=ce(),mr=b(er);{var hr=t=>{var l=Or(),i=o(l),d=o(i,!0);r(i);var v=s(i,2),u=o(v,!0);r(v),r(l),G(T=>{h(d,T),h(u,(e(Re),p(()=>e(Re).personel.nama_personel)))},[()=>(e(Re),p(()=>q(e(Re).role)))]),c(t,l)};Le(mr,t=>{e(Re),p(()=>e(Re).personel)&&t(hr)})}c(gr,er)}),r(Zt),r(lt),c(bt,lt)};Le(pr,bt=>{e(C),p(()=>e(C).personel_trip&&e(C).personel_trip.length>0)&&bt(Xt)})}r(Me),G(()=>{h(Bt,(e(C),p(()=>e(C).trip_id))),h(Ht,`${e(C),p(()=>e(C).net_loading)??""} BBL`),h(Qt,`${e(C),p(()=>e(C).net_unloading)??""} BBL`),h(cr,(e(C),p(()=>e(C).jam_loading))),h(Ot,(e(C),p(()=>e(C).jam_unloading))),h(ur,(e(C),p(()=>e(C).no_segel)))}),c(Je,Me)}),r(le),c(ve,le)},Wt=ve=>{var le=Jr();c(ve,le)};Le(Tt,ve=>{e(n),p(()=>e(n).trip_surat_jalan&&e(n).trip_surat_jalan.length>0)?ve(vr):ve(Wt,!1)})}r(It),r(Se),r(me),r(Ze),G((ve,le,Je,C,rt,Me)=>{h(lr,`${ve??""} • ${le??""}`),h(et,`${Je??""} • ${C??""}`),h(ir,(e(n),p(()=>e(n).supervisor.nama))),h(Ie,`${e(n),p(()=>e(n).bbm)??""} Liter`),h(Kt,` ${rt??""}`),h(Vt,` ${Me??""}`),h(Pt,` Data Trip (${e(n),p(()=>e(n).trip_surat_jalan?.length||0)??""})`)},[()=>(e(n),p(()=>Y(e(n).time_out))),()=>(e(n),p(()=>D(e(n).time_out))),()=>(e(n),p(()=>Y(e(n).time_back))),()=>(e(n),p(()=>D(e(n).time_back))),()=>(e(n),p(()=>$(e(n).personel_surat_jalan,"driver1"))),()=>(e(n),p(()=>$(e(n).personel_surat_jalan,"helper1")))]),c(Xe,Ze)};Le(qe,Xe=>{e(y),e(n),p(()=>e(y).has(e(n).surat_jalan_id))&&Xe(nr)})}G((Xe,Ze,me)=>{ar(K,"title",Xe),Pr(te,0,`w-5 h-5 text-gray-600 transition-transform duration-200 ${Ze??""}`),h(W,(e(n),p(()=>e(n).no_surat_jalan))),h(se,(e(n),p(()=>e(n).surat_jalan_id))),h(be,me),h(pe,(e(n),p(()=>e(n).vt.no_vt))),h(ye,(e(n),p(()=>e(n).vt.plat))),h(or,(e(n),p(()=>e(n).rute.nama_rute))),h(Qe,`${e(n),p(()=>e(n).rute.jarak)??""} km`),h(sr,`${e(n),p(()=>e(n).trip_surat_jalan?.length||0)??""} Trip`),$e.disabled=e(Z),Ce.disabled=e(Z)},[()=>(e(y),e(n),p(()=>e(y).has(e(n).surat_jalan_id)?"Tutup detail":"Lihat detail")),()=>(e(y),e(n),p(()=>e(y).has(e(n).surat_jalan_id)?"rotate-90":"")),()=>(e(n),p(()=>Y(e(n).date)))]),dt("click",K,()=>ee(e(n).surat_jalan_id)),dt("click",$e,()=>A()(e(n).surat_jalan_id)),dt("click",Ce,()=>M(e(n).surat_jalan_id)),c(_,f)}),r(P),r(x);var ue=s(x,2);{var fe=_=>{var n=Yr();c(_,n)};Le(ue,_=>{wr(B()),p(()=>B().length===0)&&_(fe)})}r(oe),r(H),G(()=>h(N,`${wr(B()),p(()=>B().length)??""} surat jalan ditemukan`)),c(_e,H),yt()}var Kr=w("<!> <!>",1),Nr=w("<!> <!>",1),Wr=w("<!> <!>",1),Gr=w("<!> <!>",1),Qr=w("<!> <!>",1),Xr=w("<!> <!>",1),Zr=w('<div class="flex items-center gap-2"><!> <div class="text-2xl font-bold text-gray-400 select-none">:</div> <!></div>');function yr(_e,k){wt(k,!1);const Q=m(),B=m();let A=ae(k,"value",12,"06:00"),y=ae(k,"minuteStep",8,5);const Z=_r(),ee=n=>String(n).padStart(2,"0"),Y=Array.from({length:24},(n,f)=>({value:ee(f),label:ee(f)})),D=n=>Array.from({length:Math.floor(60/n)},(f,I)=>{const E=ee(I*n);return{value:E,label:E}});let $=m([]),S=m([]),q=m([]),M=m([]),H=m(""),J=m("");const V=()=>{const n=e(q)?.[0]??"00",f=e(M)?.[0]??"00";A(`${n}:${f}`),Z("change",A())};br(()=>{const[n,f]=A().split(":");a(q,[n||"06"]),a(M,[f||"00"]),a(H,e(q)[0]),a(J,e(M)[0]),a($,Y),a(S,D(y())),V()});const R=()=>{a($,Y)},z=()=>{a(S,D(y()))},N=n=>{a(q,n.value),a(H,e(q)[0]),V()},oe=n=>{a(M,n.value),a(J,e(M)[0]),V()},x=n=>{a(H,n.inputValue??"");const f=e(H).toLowerCase();if(!f||f===e(q)?.[0]){a($,Y);return}a($,Y.filter(I=>I.label.includes(f)))},P=n=>{a(J,n.inputValue??"");const f=e(J).toLowerCase(),I=D(y());if(!f||f===e(M)?.[0]){a(S,I);return}a(S,I.filter(E=>E.label.includes(f)))};De(()=>e($),()=>{a(Q,ze({items:e($),itemToString:n=>n.label,itemToValue:n=>n.value}))}),De(()=>e(S),()=>{a(B,ze({items:e(S),itemToString:n=>n.label,itemToValue:n=>n.value}))}),kr(),kt();var ue=Zr(),fe=o(ue);g(fe,{class:"w-20",placeholder:"HH",get collection(){return e(Q)},get value(){return e(q)},get inputValue(){return e(H)},onOpenChange:R,onInputValueChange:x,onValueChange:N,multiple:!1,selectionBehavior:"replace",inputBehavior:"autohighlight",openOnClick:!0,children:(n,f)=>{var I=Wr(),E=b(I);g.Control(E,{children:(K,te)=>{var L=Kr(),U=b(L);g.Input(U,{class:"text-center font-mono focus:ring-2 focus:ring-blue-500"});var W=s(U,2);g.Trigger(W,{class:"hover:bg-gray-100 transition-colors"}),c(K,L)},$$slots:{default:!0}});var Oe=s(E,2);xr(Oe,{children:(K,te)=>{g.Positioner(K,{children:(L,U)=>{g.Content(L,{class:"bg-white border border-gray-200 rounded-lg shadow-lg max-h-60 overflow-y-auto overscroll-contain z-50",children:(W,je)=>{var se=ce(),ne=b(se);he(ne,1,()=>e($),xe=>xe.value,(xe,be)=>{g.Item(xe,{get item(){return e(be)},class:"px-4 py-2 hover:bg-blue-50 cursor-pointer transition-colors text-center font-mono",children:(Fe,vt)=>{var Te=Nr(),we=b(Te);g.ItemText(we,{children:(re,ye)=>{X();var ge=He();G(()=>h(ge,(e(be),p(()=>e(be).label)))),c(re,ge)},$$slots:{default:!0}});var pe=s(we,2);g.ItemIndicator(pe,{}),c(Fe,Te)},$$slots:{default:!0}})}),c(W,se)},$$slots:{default:!0}})},$$slots:{default:!0}})},$$slots:{default:!0}}),c(n,I)},$$slots:{default:!0}});var _=s(fe,4);g(_,{class:"w-20",placeholder:"MM",get collection(){return e(B)},get value(){return e(M)},get inputValue(){return e(J)},onOpenChange:z,onInputValueChange:P,onValueChange:oe,multiple:!1,selectionBehavior:"replace",inputBehavior:"autohighlight",openOnClick:!0,children:(n,f)=>{var I=Xr(),E=b(I);g.Control(E,{children:(K,te)=>{var L=Gr(),U=b(L);g.Input(U,{class:"text-center font-mono focus:ring-2 focus:ring-blue-500"});var W=s(U,2);g.Trigger(W,{class:"hover:bg-gray-100 transition-colors"}),c(K,L)},$$slots:{default:!0}});var Oe=s(E,2);xr(Oe,{children:(K,te)=>{g.Positioner(K,{children:(L,U)=>{g.Content(L,{class:"bg-white border border-gray-200 rounded-lg shadow-lg max-h-60 overflow-y-auto overscroll-contain z-50",children:(W,je)=>{var se=ce(),ne=b(se);he(ne,1,()=>e(S),xe=>xe.value,(xe,be)=>{g.Item(xe,{get item(){return e(be)},class:"px-4 py-2 hover:bg-blue-50 cursor-pointer transition-colors text-center font-mono",children:(Fe,vt)=>{var Te=Qr(),we=b(Te);g.ItemText(we,{children:(re,ye)=>{X();var ge=He();G(()=>h(ge,(e(be),p(()=>e(be).label)))),c(re,ge)},$$slots:{default:!0}});var pe=s(we,2);g.ItemIndicator(pe,{}),c(Fe,Te)},$$slots:{default:!0}})}),c(W,se)},$$slots:{default:!0}})},$$slots:{default:!0}})},$$slots:{default:!0}}),c(n,I)},$$slots:{default:!0}}),r(ue),c(_e,ue),yt()}var ea=w("<!> <!>",1),ta=w("<!> <!>",1);function Ge(_e,k){wt(k,!1);let Q=ae(k,"collection",8),B=ae(k,"value",24,()=>[]),A=ae(k,"placeholder",8,""),y=ae(k,"onOpenChange",8,()=>{}),Z=ae(k,"onInputValueChange",8,()=>{}),ee=ae(k,"onValueChange",8,()=>{}),Y=ae(k,"contentClass",8,"bg-white border border-gray-200 rounded-lg shadow-lg max-h-64 overflow-y-auto"),D=ae(k,"className",8,""),$=ae(k,"disabled",8,!1);kt(),g(_e,{get class(){return`w-full ${D()??""}`},get placeholder(){return A()},get collection(){return Q()},get onOpenChange(){return y()},get onInputValueChange(){return Z()},get onValueChange(){return ee()},get value(){return B()},multiple:!1,inputBehavior:"autohighlight",openOnClick:!0,get disabled(){return $()},children:(S,q)=>{var M=ta(),H=b(M);g.Control(H,{$$events:{click:()=>Q()?.open?.()},children:(V,R)=>{var z=ea(),N=b(z);g.Input(N,{class:"focus:ring-2 focus:ring-blue-500"});var oe=s(N,2);g.Trigger(oe,{}),c(V,z)},$$slots:{default:!0}});var J=s(H,2);xr(J,{children:(V,R)=>{g.Positioner(V,{children:(z,N)=>{g.Content(z,{get class(){return Y()},children:(oe,x)=>{var P=ce(),ue=b(P);Dr(ue,k,"default",{}),c(oe,P)},$$slots:{default:!0}})},$$slots:{default:!0}})},$$slots:{default:!0}}),c(S,M)},$$slots:{default:!0}}),yt()}var ra=w("<!> <!>",1),aa=w("<!> <!>",1),oa=w("<!> <!>",1),sa=w("<!> <!>",1),na=w("<!> <!>",1),la=w("<!> <!>",1),ia=w("<!> <!>",1),da=w("<!> <!>",1),va=$r('<svg class="animate-spin -ml-1 mr-2 h-5 w-5" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg> Menyimpan...',1),ca=$r('<svg class="w-5 h-5 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg> Simpan Surat Jalan',1),ua=w('<div class="fixed inset-0 bg-black/20 backdrop-blur-sm flex items-center justify-center z-50"><!></div>'),pa=w('<div class="w-full max-w-4xl mx-auto px-4 py-6"><div class="bg-white rounded-2xl shadow-md p-6"><div class="mb-6"><div class="flex items-center gap-3"><div class="w-10 h-10 rounded-xl bg-linear-to-br from-blue-500 to-indigo-600 flex items-center justify-center shadow-lg"><svg class="w-6 h-6 text-white" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path></svg></div> <div><h2 class="text-xl font-bold text-gray-900">Form Surat Jalan Baru</h2> <p class="text-sm text-gray-500">Lengkapi data untuk membuat surat jalan</p></div></div></div> <div class="space-y-6"><div class="grid grid-cols-1 md:grid-cols-2 gap-4"><div class="flex flex-col gap-2"><label class="text-sm font-medium text-gray-700 flex items-center gap-2"><svg class="w-4 h-4 text-blue-500" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10m-11 8h12a2 2 0 002-2V7a2 2 0 00-2-2H6a2 2 0 00-2 2v10a2 2 0 002 2z"></path></svg> Tanggal Surat Jalan <span class="text-red-500">*</span></label> <div class="relative"><input class="input w-full pr-10 cursor-pointer focus:ring-2 focus:ring-blue-500" placeholder="Pilih tanggal" readonly=""/> <svg class="absolute right-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400 pointer-events-none" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10m-11 8h12a2 2 0 002-2V7a2 2 0 00-2-2H6a2 2 0 00-2 2v10a2 2 0 002 2z"></path></svg></div></div> <div class="flex flex-col gap-2"><label class="text-sm font-medium text-gray-700 flex items-center gap-2"><svg class="w-4 h-4 text-emerald-500" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"></path></svg> Vacuum Truck <span class="text-red-500">*</span></label> <!></div></div> <div class="grid grid-cols-1 md:grid-cols-2 gap-4"><div class="flex flex-col gap-2"><label class="text-sm font-medium text-gray-700 flex items-center gap-2"><svg class="w-4 h-4 text-purple-500" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 20l-5.447-2.724A1 1 0 013 16.382V5.618a1 1 0 011.447-.894L9 7m0 13l6-3m-6 3V7m6 10l4.553 2.276A1 1 0 0021 18.382V7.618a1 1 0 00-.553-.894L15 4m0 13V4m0 0L9 7"></path></svg> Rute <span class="text-red-500">*</span></label> <!></div> <div class="flex flex-col gap-2"><label class="text-sm font-medium text-gray-700 flex items-center gap-2"><svg class="w-4 h-4 text-green-500" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path></svg> Supervisor <span class="text-red-500">*</span></label> <!></div></div> <div class="border-t border-gray-200 pt-6"><h3 class="text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2"><svg class="w-5 h-5 text-amber-500" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"></path></svg> Shift 1</h3> <div class="grid grid-cols-1 md:grid-cols-2 gap-4"><div class="flex flex-col gap-2"><label class="text-sm font-medium text-gray-700 flex items-center gap-2"><svg class="w-4 h-4 text-amber-500" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path></svg> Driver <span class="text-red-500">*</span></label> <!></div> <div class="flex flex-col gap-2"><label class="text-sm font-medium text-gray-700 flex items-center gap-2"><svg class="w-4 h-4 text-amber-500" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"></path></svg> Helper <span class="text-red-500">*</span></label> <!></div></div></div> <div class="border-t border-gray-200 pt-6"><h3 class="text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2"><svg class="w-5 h-5 text-indigo-500" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"></path></svg> Shift 2</h3> <div class="grid grid-cols-1 md:grid-cols-2 gap-4"><div class="flex flex-col gap-2"><label class="text-sm font-medium text-gray-700 flex items-center gap-2"><svg class="w-4 h-4 text-indigo-500" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path></svg> Driver</label> <!></div> <div class="flex flex-col gap-2"><label class="text-sm font-medium text-gray-700 flex items-center gap-2"><svg class="w-4 h-4 text-indigo-500" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"></path></svg> Helper</label> <!></div></div></div> <div class="border-t border-gray-200 pt-6"><div class="grid grid-cols-1 md:grid-cols-2 gap-4"><div class="flex flex-col gap-2"><label class="text-sm font-medium text-gray-700 flex items-center gap-2"><svg class="w-4 h-4 text-red-500" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 18.657A8 8 0 016.343 7.343S7 9 9 10c0-2 .5-5 2.986-7C14 5 16.09 5.777 17.656 7.343A7.975 7.975 0 0120 13a7.975 7.975 0 01-2.343 5.657z"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.879 16.121A3 3 0 1012.015 11L11 14H9c0 .768.293 1.536.879 2.121z"></path></svg> Kapasitas BBM</label> <div class="relative"><input type="text" inputmode="numeric" pattern="[0-9]*" class="input w-full pr-10 focus:ring-2 focus:ring-red-500" placeholder="0"/> <span class="absolute right-3 top-1/2 -translate-y-1/2 text-sm text-gray-500 pointer-events-none">L</span></div></div> <div class="flex flex-col gap-2"><label class="text-sm font-medium text-gray-700 flex items-center gap-2"><svg class="w-4 h-4 text-cyan-500" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path></svg> Dispatcher <span class="text-red-500">*</span></label> <!></div></div></div> <div class="border-t border-gray-200 pt-6"><div class="grid grid-cols-1 md:grid-cols-2 gap-4"><div class="flex flex-col gap-2"><label class="text-sm font-medium text-gray-700 flex items-center gap-2"><svg class="w-4 h-4 text-green-500" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3"></path></svg> Waktu Keluar VT <span class="text-red-500">*</span></label> <div class="space-y-2"><div class="relative"><input class="input w-full pr-10 cursor-pointer focus:ring-2 focus:ring-green-500" placeholder="Pilih tanggal" readonly=""/> <svg class="absolute right-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400 pointer-events-none" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10m-11 8h12a2 2 0 002-2V7a2 2 0 00-2-2H6a2 2 0 00-2 2v10a2 2 0 002 2z"></path></svg></div> <!></div></div> <div class="flex flex-col gap-2"><label class="text-sm font-medium text-gray-700 flex items-center gap-2"><svg class="w-4 h-4 text-orange-500" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16l-4-4m0 0l4-4m-4 4h18"></path></svg> Waktu Kembali VT <span class="text-red-500">*</span></label> <div class="space-y-2"><div class="relative"><input class="input w-full pr-10 cursor-pointer focus:ring-2 focus:ring-orange-500" placeholder="Pilih tanggal" readonly=""/> <svg class="absolute right-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400 pointer-events-none" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10m-11 8h12a2 2 0 002-2V7a2 2 0 00-2-2H6a2 2 0 00-2 2v10a2 2 0 002 2z"></path></svg></div> <!></div></div></div></div> <div class="flex justify-end pt-4 border-t border-gray-200"><!></div></div></div></div> <!>',1);function ga(_e,k){wt(k,!1);const Q=m(),B=m(),A=m(),y=m(),Z=m(),ee=m(),Y=m();let D=m(!1);const $=_r();let S=m("");const q=t=>{const l=t.target.value;if(l===""){a(S,"");return}/^\d+$/.test(l)&&a(S,l)};let M=m("18:00"),H=m("16:00"),J=[],V=m([]),R=m([]),z=m([]),N=m([]);const oe=t=>t?.[0]??null,x=(t="")=>{const l=oe(e(N)),i=J.filter(d=>{const v=d.nama_personel.toLowerCase().includes(t),u=l&&String(d.personel_id)===String(l);return v&&!u});return St(i)},P=(t="")=>{const l=oe(e(z)),i=J.filter(d=>{const v=d.nama_personel.toLowerCase().includes(t),u=l&&String(d.personel_id)===String(l);return v&&!u});return St(i)},ue=t=>{const l=(t.inputValue??"").toLowerCase();a(V,x(l))},fe=t=>{const l=(t.inputValue??"").toLowerCase();a(R,P(l))},_=t=>{a(z,t.value),a(R,P("")),E(e(z)?.[0],1)},n=t=>{a(N,t.value),a(V,x("")),E(e(N)?.[0],2)},f=()=>{a(V,x(""))},I=()=>{a(R,P(""))},E=(t,l=1)=>{if(!t)return;const i=J.find(u=>String(u.personel_id)===String(t));if(!i)return;const d=i.def_helper;if(!d){l===1&&a(U,[]),l===2&&a(W,[]);return}K.find(u=>String(u.personel_id)===String(d))&&(l===1&&(a(U,[String(d)]),a(te,se("")),a(L,ne(""))),l===2&&(a(W,[String(d)]),a(L,ne("")),a(te,se(""))))},Oe=(t,l)=>{if(!l||t.some(v=>String(v.personel_id)===String(l)))return t;const d=K.find(v=>String(v.personel_id)===String(l));return d?[d,...t]:t};let K=[],te=m([]),L=m([]),U=m([]),W=m([]);const je=t=>t?.[0]??null,se=(t="")=>{const l=je(e(W));let i=K.filter(d=>{const v=d.nama_personel.toLowerCase().includes(t),u=l&&String(d.personel_id)===String(l);return v&&!u});return Oe(i,je(e(U)))},ne=(t="")=>{const l=je(e(U));let i=K.filter(d=>{const v=d.nama_personel.toLowerCase().includes(t),u=l&&String(d.personel_id)===String(l);return v&&!u});return Oe(i,je(e(W)))},xe=t=>{const l=(t.inputValue??"").toLowerCase();a(te,se(l))},be=t=>{const l=(t.inputValue??"").toLowerCase();a(L,ne(l))},Fe=t=>{a(U,t.value),a(L,ne(""))},vt=t=>{a(W,t.value),a(te,se(""))},Te=()=>{a(te,se(""))},we=()=>{a(L,ne(""))};let pe=[],re=m([]),ye=m([]),ge=!1;const $t=t=>{const l=(t.inputValue??"").toLowerCase();a(re,pe.filter(i=>(i.nama??"").toLowerCase().includes(l)))},or=t=>{ge=!0,a(ye,t.value),a(re,pe)},Ft=()=>{a(re,pe)};let Qe=[],ke=m([]),Ye=m([]);const sr=t=>{const l=(t.inputValue??"").toLowerCase();a(ke,Qe.filter(i=>i.nama.toLowerCase().includes(l)))},At=t=>{a(Ye,t.value)},Jt=()=>{a(ke,Qe)};let $e=[],Ce=m([]),qe=m([]);const nr=t=>{const l=(t.inputValue??"").toLowerCase();a(Ce,$e.filter(i=>(i.nama_rute??"").toLowerCase().includes(l)))},Xe=t=>{a(qe,t.value),a(Ce,$e);const l=e(qe)?.[0];if(!l)return;const i=$e.find(v=>String(v.rute_id)===String(l));if(!i)return;const d=i.user_id;d&&((!ge||!e(ye)?.length)&&a(ye,[String(d)]),a(re,pe))},Ze=()=>{a(Ce,$e)};let me=[],Se=m([]),Ve=m([]),ct=m();const Rt=()=>{a(Se,me)},Ct=()=>{const t=e(Ve)?.[0];return t?me.find(l=>String(l.vt_id)===String(t))??null:null},Ut=t=>{const l=(t.inputValue??"").toLowerCase().trim(),i=Ct();if(!l){a(Se,me);return}let d=me.filter(v=>`${v.no_vt??""} - ${v.plat??""} ${v.vt_id??""}`.toLowerCase().includes(l));i&&!d.some(v=>String(v.vt_id)===String(i.vt_id))&&(d=[i,...d]),a(Se,d)},lr=t=>{a(Ve,t.value),a(V,x("")),a(R,P(""))},Yt=()=>{const t=e(Ve)?.[0];if(!t)return[];const l=me.find(i=>String(i.vt_id)===String(t));return l?(l.personels??[]).filter(i=>i.is_driver).map(i=>String(i.personel_id)):[]},St=t=>{const l=Yt();return[...t].sort((i,d)=>{const v=l.includes(String(i.personel_id)),u=l.includes(String(d.personel_id));return v&&!u?-1:!v&&u?1:i.nama_personel.localeCompare(d.nama_personel)})};let et=m(),Ee=m(),Ke=m(),Ae="",Ne="",tt="";const ir=async()=>{a(D,!0);try{me=(await Ue.getVT()).vts??[],a(Se,me),$e=(await Ue.getRute()).rutes,a(Ce,$e),pe=(await Ue.getSupervisor()).users,a(re,pe),Qe=(await Ue.getDispatcher()).users,a(ke,Qe),J=(await Ue.getDrivers()).drivers??[],a(V,x("")),a(R,P("")),K=(await Ue.getHelpers()).helpers??[],a(te,se("")),a(L,ne(""))}catch(t){console.error("Error fetching data:",t),Be?.error("Gagal memuat data")}a(D,!1)},qt=()=>{const t=new Date,l=new Date(t);l.setDate(t.getDate()-1),Ae=Ie(t),Ne=Ie(l),tt=Ie(t),a(M,"18:00"),a(H,"16:00"),a(S,""),a(Ve,[]),a(qe,[]),a(ye,[]),a(Ye,[]),a(z,[]),a(U,[]),a(N,[]),a(W,[]),ge=!1,a(Se,me),a(Ce,$e),a(re,pe),a(ke,Qe),a(V,x("")),a(R,P("")),a(te,se("")),a(L,ne("")),e(et)?._flatpickr&&e(et)._flatpickr.setDate(t,!0),e(Ee)?._flatpickr&&e(Ee)._flatpickr.setDate(l,!0),e(Ke)?._flatpickr&&e(Ke)._flatpickr.setDate(t,!0)},Et=async()=>{if(!Ae){Be?.error("Pilih tanggal surat jalan");return}if(!e(Ve).length){Be?.error("Pilih Vacuum Truck");return}if(!e(qe).length){Be?.error("Pilih rute");return}if(!e(ye).length){Be?.error("Pilih supervisor");return}if(!e(Ye).length){Be?.error("Pilih dispatcher");return}if(!e(z).length){Be?.error("Pilih driver shift pagi");return}if(!e(U).length){Be?.error("Pilih helper shift pagi");return}a(D,!0);const t=`${Ne} ${e(M)}:00`,l=`${tt} ${e(H)}:00`,i={date:Ae,vt_id:e(Ve)[0],rute_id:e(qe)[0],supervisor_id:e(ye)[0],dispatcher_id:e(Ye)[0],driver1:e(z)[0],helper1:e(U)[0],driver2:e(N)[0]||null,helper2:e(W)[0]||null,time_out:t,time_back:l,bbm:e(S)||"0"};try{await Ue.createSJ(i),qt(),$("refresh"),Be?.success("Surat Jalan berhasil dibuat")}catch(d){console.error(d),Be?.error(d.message||"Gagal membuat Surat Jalan")}a(D,!1)};br(()=>{const t=new Date;new Date(t).setDate(t.getDate()+1);const i=new Date(t);i.setDate(t.getDate()-1),rr(e(et),{mode:"single",dateFormat:"Y-m-d",altInput:!0,altFormat:"d-m-Y",defaultDate:t,onChange:([d])=>{d&&(Ae=Ie(d))}}),rr(e(Ee),{mode:"single",dateFormat:"Y-m-d",altInput:!0,altFormat:"d-m-Y",defaultDate:i,onChange:([d])=>{d&&(Ne=Ie(d))}}),rr(e(Ke),{mode:"single",dateFormat:"Y-m-d",altInput:!0,altFormat:"d-m-Y",defaultDate:t,onChange:([d])=>{d&&(tt=Ie(d))}}),Ae=Ie(t),Ne=Ie(i),tt=Ie(t),ir()});const Ie=t=>t.getFullYear()+"-"+String(t.getMonth()+1).padStart(2,"0")+"-"+String(t.getDate()).padStart(2,"0");De(()=>e(V),()=>{a(Q,ze({items:e(V),itemToString:t=>t.nama_personel,itemToValue:t=>String(t.personel_id)}))}),De(()=>e(R),()=>{a(B,ze({items:e(R),itemToString:t=>t.nama_personel,itemToValue:t=>String(t.personel_id)}))}),De(()=>e(te),()=>{a(A,ze({items:e(te),itemToString:t=>t.nama_personel,itemToValue:t=>String(t.personel_id)}))}),De(()=>e(L),()=>{a(y,ze({items:e(L),itemToString:t=>t.nama_personel,itemToValue:t=>String(t.personel_id)}))}),De(()=>e(re),()=>{a(Z,ze({items:e(re),itemToString:t=>t.nama,itemToValue:t=>String(t.user_id)}))}),De(()=>e(ke),()=>{a(ee,ze({items:e(ke),itemToString:t=>t.nama,itemToValue:t=>String(t.user_id)}))}),De(()=>e(Ce),()=>{a(Y,ze({items:e(Ce),itemToString:t=>t.nama_rute,itemToValue:t=>String(t.rute_id)}))}),De(()=>e(Se),()=>{a(ct,ze({items:e(Se),itemToString:t=>`${t.no_vt} - ${t.plat}`,itemToValue:t=>String(t.vt_id)}))}),kr(),kt();var ut=pa(),pt=b(ut),gt=o(pt),Kt=s(o(gt),2),mt=o(Kt),Vt=o(mt),Nt=s(o(Vt),2),dr=o(Nt);tr(dr,t=>a(et,t),()=>e(et)),X(2),r(Nt),r(Vt);var It=s(Vt,2),Mt=s(o(It),2);Ge(Mt,{placeholder:"Cari VT...",get collection(){return e(ct)},onOpenChange:Rt,onInputValueChange:Ut,get value(){return e(Ve)},onValueChange:lr,children:(t,l)=>{var i=ce(),d=b(i);he(d,1,()=>e(Se),v=>v.vt_id,(v,u)=>{g.Item(v,{get item(){return e(u)},class:"px-4 py-2 hover:bg-blue-50 cursor-pointer transition-colors",children:(T,Pe)=>{var O=ra(),j=b(O);g.ItemText(j,{children:(de,it)=>{X();var F=He();G(()=>h(F,`${e(u),p(()=>e(u).no_vt)??""} — ${e(u),p(()=>e(u).plat)??""}`)),c(de,F)},$$slots:{default:!0}});var ie=s(j,2);g.ItemIndicator(ie,{}),c(T,O)},$$slots:{default:!0}})}),c(t,i)},$$slots:{default:!0}}),r(It),r(mt);var Pt=s(mt,2),Tt=o(Pt),vr=s(o(Tt),2);Ge(vr,{placeholder:"Cari Rute...",get collection(){return e(Y)},onInputValueChange:nr,onValueChange:Xe,onOpenChange:Ze,get value(){return e(qe)},children:(t,l)=>{var i=ce(),d=b(i);he(d,1,()=>e(Ce),v=>v.rute_id,(v,u)=>{g.Item(v,{get item(){return e(u)},class:"px-4 py-2 hover:bg-purple-50 cursor-pointer transition-colors",children:(T,Pe)=>{var O=aa(),j=b(O);g.ItemText(j,{children:(de,it)=>{X();var F=He();G(()=>h(F,(e(u),p(()=>e(u).nama_rute)))),c(de,F)},$$slots:{default:!0}});var ie=s(j,2);g.ItemIndicator(ie,{}),c(T,O)},$$slots:{default:!0}})}),c(t,i)},$$slots:{default:!0}}),r(Tt);var Wt=s(Tt,2),ve=s(o(Wt),2);Ge(ve,{placeholder:"Cari Supervisor...",get collection(){return e(Z)},onOpenChange:Ft,onInputValueChange:$t,onValueChange:or,get value(){return e(ye)},children:(t,l)=>{var i=ce(),d=b(i);he(d,1,()=>e(re),v=>v.user_id,(v,u)=>{g.Item(v,{get item(){return e(u)},class:"px-4 py-2 hover:bg-green-50 cursor-pointer transition-colors",children:(T,Pe)=>{var O=oa(),j=b(O);g.ItemText(j,{children:(de,it)=>{X();var F=He();G(()=>h(F,(e(u),p(()=>e(u).nama)))),c(de,F)},$$slots:{default:!0}});var ie=s(j,2);g.ItemIndicator(ie,{}),c(T,O)},$$slots:{default:!0}})}),c(t,i)},$$slots:{default:!0}}),r(Wt),r(Pt);var le=s(Pt,2),Je=s(o(le),2),C=o(Je),rt=s(o(C),2);Ge(rt,{placeholder:"Cari Driver...",get collection(){return e(Q)},onOpenChange:f,onInputValueChange:ue,onValueChange:_,get value(){return e(z)},children:(t,l)=>{var i=ce(),d=b(i);he(d,1,()=>e(V),v=>v.personel_id,(v,u)=>{g.Item(v,{get item(){return e(u)},class:"px-4 py-2 hover:bg-amber-50 cursor-pointer transition-colors",children:(T,Pe)=>{var O=sa(),j=b(O);g.ItemText(j,{children:(de,it)=>{X();var F=He();G(()=>h(F,(e(u),p(()=>e(u).nama_personel)))),c(de,F)},$$slots:{default:!0}});var ie=s(j,2);g.ItemIndicator(ie,{}),c(T,O)},$$slots:{default:!0}})}),c(t,i)},$$slots:{default:!0}}),r(C);var Me=s(C,2),at=s(o(Me),2);Ge(at,{placeholder:"Cari Helper...",get collection(){return e(A)},onOpenChange:Te,onInputValueChange:xe,onValueChange:Fe,get value(){return e(U)},children:(t,l)=>{var i=ce(),d=b(i);he(d,1,()=>e(te),v=>v.personel_id,(v,u)=>{g.Item(v,{get item(){return e(u)},class:"px-4 py-2 hover:bg-amber-50 cursor-pointer transition-colors",children:(T,Pe)=>{var O=na(),j=b(O);g.ItemText(j,{children:(de,it)=>{X();var F=He();G(()=>h(F,(e(u),p(()=>e(u).nama_personel)))),c(de,F)},$$slots:{default:!0}});var ie=s(j,2);g.ItemIndicator(ie,{}),c(T,O)},$$slots:{default:!0}})}),c(t,i)},$$slots:{default:!0}}),r(Me),r(Je),r(le);var We=s(le,2),ot=s(o(We),2),Bt=o(ot),Dt=s(o(Bt),2);Ge(Dt,{placeholder:"Cari Driver...",get collection(){return e(B)},onOpenChange:I,onInputValueChange:fe,onValueChange:n,get value(){return e(N)},children:(t,l)=>{var i=ce(),d=b(i);he(d,1,()=>e(R),v=>v.personel_id,(v,u)=>{g.Item(v,{get item(){return e(u)},class:"px-4 py-2 hover:bg-indigo-50 cursor-pointer transition-colors",children:(T,Pe)=>{var O=la(),j=b(O);g.ItemText(j,{children:(de,it)=>{X();var F=He();G(()=>h(F,(e(u),p(()=>e(u).nama_personel)))),c(de,F)},$$slots:{default:!0}});var ie=s(j,2);g.ItemIndicator(ie,{}),c(T,O)},$$slots:{default:!0}})}),c(t,i)},$$slots:{default:!0}}),r(Bt);var ht=s(Bt,2),Gt=s(o(ht),2);Ge(Gt,{placeholder:"Cari Helper...",get collection(){return e(y)},onOpenChange:we,onInputValueChange:be,onValueChange:vt,get value(){return e(W)},children:(t,l)=>{var i=ce(),d=b(i);he(d,1,()=>e(L),v=>v.personel_id,(v,u)=>{g.Item(v,{get item(){return e(u)},class:"px-4 py-2 hover:bg-indigo-50 cursor-pointer transition-colors",children:(T,Pe)=>{var O=ia(),j=b(O);g.ItemText(j,{children:(de,it)=>{X();var F=He();G(()=>h(F,(e(u),p(()=>e(u).nama_personel)))),c(de,F)},$$slots:{default:!0}});var ie=s(j,2);g.ItemIndicator(ie,{}),c(T,O)},$$slots:{default:!0}})}),c(t,i)},$$slots:{default:!0}}),r(ht),r(ot),r(We);var Ht=s(We,2),ft=o(Ht),xt=o(ft),Qt=s(o(xt),2),st=o(Qt);Vr(st),X(2),r(Qt),r(xt);var zt=s(xt,2),cr=s(o(zt),2);Ge(cr,{placeholder:"Cari Dispatcher...",get collection(){return e(ee)},onOpenChange:Jt,onInputValueChange:sr,onValueChange:At,get value(){return e(Ye)},children:(t,l)=>{var i=ce(),d=b(i);he(d,1,()=>e(ke),v=>v.user_id,(v,u)=>{g.Item(v,{get item(){return e(u)},class:"px-4 py-2 hover:bg-cyan-50 cursor-pointer transition-colors",children:(T,Pe)=>{var O=da(),j=b(O);g.ItemText(j,{children:(de,it)=>{X();var F=He();G(()=>h(F,(e(u),p(()=>e(u).nama)))),c(de,F)},$$slots:{default:!0}});var ie=s(j,2);g.ItemIndicator(ie,{}),c(T,O)},$$slots:{default:!0}})}),c(t,i)},$$slots:{default:!0}}),r(zt),r(ft),r(Ht);var nt=s(Ht,2),Lt=o(nt),Ot=o(Lt),jt=s(o(Ot),2),_t=o(jt),ur=o(_t);tr(ur,t=>a(Ee,t),()=>e(Ee)),X(2),r(_t);var pr=s(_t,2);yr(pr,{get value(){return e(M)},set value(t){a(M,t)},$$legacy:!0}),r(jt),r(Ot);var Xt=s(Ot,2),bt=s(o(Xt),2),lt=o(bt),Zt=o(lt);tr(Zt,t=>a(Ke,t),()=>e(Ke)),X(2),r(lt);var gr=s(lt,2);yr(gr,{get value(){return e(H)},set value(t){a(H,t)},$$legacy:!0}),r(bt),r(Xt),r(Lt),r(nt);var Re=s(nt,2),er=o(Re);Br(er,{severity:"success",get disabled(){return e(D)},class:"px-8 py-3 text-base font-semibold",$$events:{click:Et},children:(t,l)=>{var i=ce(),d=b(i);{var v=T=>{var Pe=va();X(),c(T,Pe)},u=T=>{var Pe=ca();X(),c(T,Pe)};Le(d,T=>{e(D)?T(v):T(u,!1)})}c(t,i)},$$slots:{default:!0}}),r(Re),r(Kt),r(gt),r(pt);var mr=s(pt,2);{var hr=t=>{var l=ua(),i=o(l);Cr(i,{}),r(l),c(t,l)};Le(mr,t=>{e(D)&&t(hr)})}G(()=>Ir(st,e(S))),dt("input",st,q),c(_e,ut),yt()}var ma=w('<div class="fixed inset-0 bg-black/20 backdrop-blur-sm flex items-center justify-center z-50"><div class="bg-white rounded-2xl p-8 shadow-2xl"><!></div></div>'),ha=w('<div class="space-y-6"><div class="bg-white rounded-xl shadow-sm p-6"><div class="flex items-center justify-between mb-6"><div class="flex items-center gap-3"><div class="w-12 h-12 rounded-xl bg-linear-to-br from-blue-500 to-indigo-600 flex items-center justify-center shadow-lg"><svg class="w-7 h-7 text-white" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path></svg></div> <div><h1 class="text-2xl font-bold text-gray-900">Surat Jalan</h1> <p class="text-sm text-gray-500">Kelola dan monitoring surat jalan vacuum truck</p></div></div></div> <div class="flex flex-col gap-2"><label class="text-sm font-medium text-gray-700 flex items-center gap-2"><svg class="w-4 h-4 text-blue-500" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10m-11 8h12a2 2 0 002-2V7a2 2 0 00-2-2H6a2 2 0 00-2 2v10a2 2 0 002 2z"></path></svg> Filter Tanggal</label> <div class="relative w-full max-w-md"><input class="input w-full pr-10 cursor-pointer focus:ring-2 focus:ring-blue-500 transition-all" placeholder="Pilih range tanggal" readonly=""/> <svg class="absolute right-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400 pointer-events-none" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10m-11 8h12a2 2 0 002-2V7a2 2 0 00-2-2H6a2 2 0 00-2 2v10a2 2 0 002 2z"></path></svg></div></div></div> <!> <!> <!> <!></div>');function La(_e,k){wt(k,!1);let Q=m(!1),B=m(),A=[],y=m(!1),Z=m(""),ee=m([]);const Y=async()=>{a(Q,!0);try{const x=await Ue.getSJByDates({dates:A});a(ee,x.surat_jalans)}catch(x){console.error(x)}a(Q,!1)},D=x=>x.getFullYear()+"-"+String(x.getMonth()+1).padStart(2,"0")+"-"+String(x.getDate()).padStart(2,"0"),$=x=>{a(Z,`${Mr}/uploads/sj/${x}.pdf`),a(y,!0)};br(()=>{const x=new Date;rr(e(B),{mode:"range",dateFormat:"Y-m-d",altInput:!0,altFormat:"d-m-Y",locale:{rangeSeparator:" sampai "},defaultDate:[x,x],onChange:(P,ue)=>{if(P.length===1)A=[D(P[0])];else if(P.length===2){const fe=D(P[0]),_=D(P[1]);fe===_?A=[fe]:A=[fe,_],Y()}console.log("dateArray:",A)}}),A=[D(x)],Y()}),kt();var S=ha(),q=o(S),M=s(o(q),2),H=s(o(M),2),J=o(H);tr(J,x=>a(B,x),()=>e(B)),X(2),r(H),r(M),r(q);var V=s(q,2);Er(V,{get surjals(){return e(ee)},onPreview:$});var R=s(V,2);ga(R,{$$events:{refresh:Y}});var z=s(R,2);zr(z,{get show(){return e(y)},get pdfUrl(){return e(Z)},onClose:()=>a(y,!1)});var N=s(z,2);{var oe=x=>{var P=ma(),ue=o(P),fe=o(ue);Cr(fe,{}),r(ue),r(P),c(x,P)};Le(N,x=>{e(Q)&&x(oe)})}r(S),c(_e,S),yt()}export{La as component};
